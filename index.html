<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vaishnava Vibes | Eternal Chanting</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Outfit', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                    },
                    colors: {
                        'saffron': '#FF9933',
                        'deep-blue': '#1a237e',
                        'gold': '#FFD700',
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'spin-slow': 'spin 12s linear infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-20px)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .text-glow {
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        .bead-glow {
            box-shadow: 0 0 30px rgba(255, 153, 51, 0.4);
        }
        /* Hide scrollbar for clean look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1a1a1a;
        }
        ::-webkit-scrollbar-thumb {
            background: #d4af37;
            border-radius: 4px;
        }
    </style>
</head>
<body class="bg-gray-900 text-white overflow-x-hidden min-h-screen relative">
    
    <!-- Background Slideshow/Image -->
    <div class="fixed inset-0 z-0 transition-opacity duration-1000 ease-in-out" id="bg-container">
        <div class="absolute inset-0 bg-gradient-to-t from-gray-900 via-gray-900/80 to-transparent z-10"></div>
        <img src="assets/RadhaVallabh.jpeg" id="bg-image" class="w-full h-full object-cover object-center scale-110 motion-safe:animate-pulse-slow opacity-60" alt="Divine Background">
    </div>

    <!-- Main Content -->
    <div class="relative z-20 container mx-auto px-4 py-8 min-h-screen flex flex-col justify-between">
        
        <!-- Header -->
        <header class="flex justify-between items-center animate-fade-in-down">
            <div class="flex items-center gap-3">
                <i class="fas fa-om text-4xl text-saffron drop-shadow-lg"></i>
                <h1 class="text-3xl font-serif italic font-bold bg-clip-text text-transparent bg-gradient-to-r from-saffron to-gold text-glow">
                    Vaishnava Vibes
                </h1>
            </div>
            
            <button onclick="toggleAudio()" id="audio-btn" class="glass rounded-full p-4 transition-all hover:scale-110 hover:bg-white/20 group">
                <i class="fas fa-music text-xl text-saffron group-hover:text-white transition-colors"></i>
            </button>
        </header>

        <!-- Main Chanting Interface -->
        <main class="flex flex-col items-center justify-center flex-grow py-12">
            
            <div class="relative group cursor-pointer mb-12" onclick="incrementCounter()">
                <!-- Decorative Ring -->
                <div class="absolute -inset-8 bg-gradient-to-r from-saffron to-purple-600 rounded-full opacity-20 group-hover:opacity-40 blur-xl transition-all duration-500 animate-spin-slow"></div>
                
                <!-- Main Bead -->
                <div class="relative w-64 h-64 md:w-80 md:h-80 glass rounded-full flex flex-col items-center justify-center border-2 border-white/10 shadow-2xl bead-glow transition-transform active:scale-95 duration-200">
                    <img src="assets/bead_texture.png" class="absolute inset-0 w-full h-full object-cover rounded-full opacity-30 mix-blend-overlay" alt="Texture">
                    
                    <span class="text-xs uppercase tracking-[0.3em] text-gray-400 mb-2">Chant & Tap</span>
                    <h2 id="mantra-count" class="text-8xl font-serif font-bold text-white drop-shadow-[0_4px_4px_rgba(0,0,0,0.5)]">0</h2>
                    <div class="mt-4 flex items-center gap-2 text-saffron/80">
                        <i class="fas fa-ring"></i>
                        <span id="round-count" class="text-sm font-medium">Round 1</span>
                    </div>
                </div>

                <!-- Ripple Effect Container -->
                <div id="ripple-container" class="absolute inset-0 pointer-events-none overflow-hidden rounded-full"></div>
            </div>

            <!-- Mantra Text -->
            <div class="text-center space-y-4 max-w-2xl mx-auto glass p-8 rounded-2xl animate-float">
                <p class="text-xl md:text-3xl font-serif leading-relaxed text-yellow-100">
                    <span class="block">Hare Krishna Hare Krishna</span>
                    <span class="block">Krishna Krishna Hare Hare</span>
                    <span class="block text-saffron mt-2">Hare Rama Hare Rama</span>
                    <span class="block text-saffron">Rama Rama Hare Hare</span>
                </p>
            </div>

        </main>

        <!-- Gallery / Footer -->
        <footer class="mt-auto">
            <div class="flex overflow-x-auto gap-4 pb-4 px-2 snap-x hide-scroll" id="image-gallery">
                <!-- Javascript will populate this -->
            </div>
            
            <div class="flex justify-between items-end mt-4 text-xs text-gray-500 font-sans border-t border-white/10 pt-4">
                <p>Chant for Peace â€¢ <span id="total-chants-session">0</span> total today</p>
                <div class="flex gap-4">
                    <button onclick="resetCounter()" class="hover:text-red-400 transition-colors">Reset Round</button>
                    <!-- <button class="hover:text-white transition-colors">Settings</button> -->
                </div>
            </div>
        </footer>
    </div>

    <!-- Audio Elements -->
    <audio id="bg-music" loop>
        <source src="assets/mahamantra.ogg" type="audio/ogg">
    </audio>
    <audio id="click-sound">
        <source src="assets/hairbol.ogg" type="audio/ogg">
    </audio>

    <script>
        // State
        let count = 0;
        let rounds = 0;
        let totalChants = 0;
        const BEADS_PER_ROUND = 108;
        let isPlaying = false;

        // Assets for gallery and background
        const images = [
            'assets/RadhaVallabh.jpeg',
            'assets/Krishna.jpeg',
            'assets/MahaPrabhu.jpeg', 
            'assets/radha-madhav.jpeg',
            'assets/radhaRaman.jpeg',
            'assets/radha_krishna.png',
            'assets/guru.png'
        ];

        // Elements
        const countEl = document.getElementById('mantra-count');
        const roundEl = document.getElementById('round-count');
        const sessionEl = document.getElementById('total-chants-session');
        const bgImage = document.getElementById('bg-image');
        const audioBtn = document.getElementById('audio-btn');
        const bgMusic = document.getElementById('bg-music');
        const clickSound = document.getElementById('click-sound');

        // Init
        function init() {
            renderGallery();
            // Load from local storage if needed
            const saved = localStorage.getItem('chantData');
            if (saved) {
                const data = JSON.parse(saved);
                count = data.count || 0;
                rounds = data.rounds || 0;
                // Don't restore session total strictly, or keep it separate.
                updateDisplay();
            }
        }

        // Logic
        function incrementCounter() {
            count++;
            totalChants++;
            
            // Play subtle click sound (optional, very short)
            // clickSound.currentTime = 0;
            // clickSound.play().catch(e => {});

            // Animations
            triggerRipple();
            
            if (count >= BEADS_PER_ROUND) {
                completeRound();
            }

            updateDisplay();
            saveData();
            
            // Change background occasionally? Or just let user select.
        }

        function completeRound() {
            count = 0;
            rounds++;
            // Could play a bell or vibration here
            const notification = new Audio('assets/hairbol.ogg'); // Using hairbol as round complete or similar
            notification.play().catch(e=>{});
            
            // Celebration effect
            confettiEffect();
        }

        function resetCounter() {
            if(confirm('Reset current round?')) {
                count = 0;
                updateDisplay();
                saveData();
            }
        }

        function updateDisplay() {
            countEl.innerText = count;
            roundEl.innerText = `Round ${rounds + 1}`;
            sessionEl.innerText = totalChants;
        }

        function saveData() {
            localStorage.setItem('chantData', JSON.stringify({ count, rounds }));
        }

        // Audio Toggle
        function toggleAudio() {
            if (isPlaying) {
                bgMusic.pause();
                audioBtn.innerHTML = '<i class="fas fa-music text-xl text-saffron group-hover:text-white transition-colors"></i>';
                audioBtn.classList.remove('animate-pulse');
            } else {
                bgMusic.play().catch(e => alert("Please interact with the page first"));
                audioBtn.innerHTML = '<i class="fas fa-pause text-xl text-saffron group-hover:text-white transition-colors"></i>';
                audioBtn.classList.add('animate-pulse');
            }
            isPlaying = !isPlaying;
        }

        // Gallery
        function renderGallery() {
            const container = document.getElementById('image-gallery');
            images.forEach(img => {
                const el = document.createElement('div');
                el.className = 'flex-shrink-0 w-20 h-20 md:w-24 md:h-24 rounded-xl overflow-hidden cursor-pointer border-2 border-transparent hover:border-saffron transition-all relative group';
                el.innerHTML = `<img src="${img}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500">`;
                el.onclick = () => setBackground(img);
                container.appendChild(el);
            });
        }

        function setBackground(src) {
            // Fade out current
            bgImage.style.opacity = '0';
            setTimeout(() => {
                bgImage.src = src;
                bgImage.onload = () => {
                    bgImage.style.opacity = '0.6';
                };
            }, 300);
        }

        function triggerRipple() {
            // Visual feedback on tap
            const bead = document.querySelector('.glass');
            bead.animate([
                { transform: 'scale(0.95)', borderColor: 'rgba(255, 153, 51, 0.8)' },
                { transform: 'scale(1)', borderColor: 'rgba(255, 255, 255, 0.1)' }
            ], {
                duration: 150,
                easing: 'cubic-bezier(0.4, 0, 0.2, 1)'
            });
        }

        function confettiEffect() {
            // Simple visual celebration using basic particles
            // (Simplified for vanilla JS without external libraries)
            const colors = ['#FFD700', '#FF9933', '#FFFFFF'];
            for(let i=0; i<30; i++) {
                createParticle(colors[Math.floor(Math.random() * colors.length)]);
            }
        }

        function createParticle(color) {
            const p = document.createElement('div');
            p.style.position = 'fixed';
            p.style.left = '50%';
            p.style.top = '50%';
            p.style.width = '10px';
            p.style.height = '10px';
            p.style.backgroundColor = color;
            p.style.borderRadius = '50%';
            p.style.pointerEvents = 'none';
            p.style.zIndex = '100';
            
            const angle = Math.random() * Math.PI * 2;
            const velocity = 5 + Math.random() * 5;
            const tx = Math.cos(angle) * 100 * (Math.random() + 0.5);
            const ty = Math.sin(angle) * 100 * (Math.random() + 0.5);

            document.body.appendChild(p);

            p.animate([
                { transform: 'translate(0, 0) scale(1)', opacity: 1 },
                { transform: `translate(${tx}px, ${ty}px) scale(0)`, opacity: 0 }
            ], {
                duration: 800 + Math.random() * 400,
                easing: 'ease-out'
            }).onfinish = () => p.remove();
        }

        // Init App
        init();

    </script>
</body>
</html>
